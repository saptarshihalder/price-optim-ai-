import{r as l,j as e,a as o}from"./index-50404dee.js";import{c as N,C as x,b as g,d as m,g as w,a as h,e as p,B as R}from"./createLucideIcon-860b63ca.js";import{P as T}from"./progress-7746fc92.js";import{S,A as C,a as k}from"./alert-fd583cd1.js";import{b as u,C as z}from"./index-86c49e70.js";/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=N("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=N("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=N("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),H=()=>{const[y,c]=l.useState(!1),[n,E]=l.useState(null),[t,I]=l.useState(null),[a,b]=l.useState([]),[i,A]=l.useState(["Coffee Mug"]),F=async()=>{try{c(!0),b([]);const r=await(await u.start_scraping({target_products:i,max_products_per_store:17})).json();E(r.task_id),o.success("Scraping started successfully!")}catch(s){console.error("Error starting scraping:",s),o.error("Failed to start scraping"),c(!1)}};l.useEffect(()=>{if(!n)return;const r=setInterval(async()=>{try{const d=await(await u.get_scraping_progress({taskId:n})).json();if(I(d),d.status==="completed"){const v=await(await u.get_scraping_results({taskId:n})).json();b(v),c(!1),o.success(`Scraping completed! Found ${v.length} products.`)}else d.status==="failed"&&(c(!1),o.error("Scraping failed. Check the error logs."))}catch(f){console.error("Error polling progress:",f)}},2e3);return()=>clearInterval(r)},[n]);const B=s=>{switch(s){case"pending":return e.jsx(P,{className:"h-4 w-4 text-yellow-500"});case"running":return e.jsx(j,{className:"h-4 w-4 text-blue-500 animate-spin"});case"completed":return e.jsx(z,{className:"h-4 w-4 text-green-500"});case"failed":return e.jsx(_,{className:"h-4 w-4 text-red-500"});default:return e.jsx(P,{className:"h-4 w-4 text-gray-500"})}},D=s=>{switch(s){case"pending":return"bg-yellow-500/20 text-yellow-300";case"running":return"bg-blue-500/20 text-blue-300";case"completed":return"bg-green-500/20 text-green-300";case"failed":return"bg-red-500/20 text-red-300";default:return"bg-gray-500/20 text-gray-300"}},L=t?t.completed_stores/t.total_stores*100:0;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500",children:"Competitor Price Scraping Engine"}),e.jsx("p",{className:"text-gray-300 text-lg",children:"Concurrent multi-store data collection from 15 target competitors"})]}),e.jsxs(x,{className:"bg-gray-800/50 border-gray-700",children:[e.jsxs(g,{children:[e.jsxs(m,{className:"text-green-400 flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Scraping Control Panel"]}),e.jsx(w,{className:"text-gray-400",children:"Configure and monitor competitor price scraping across multiple stores"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-300 mb-2 block",children:["Target Products (",i.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map((s,r)=>e.jsx(p,{variant:"outline",className:"bg-gray-700 text-gray-300 border-gray-600",children:s},r))})]}),e.jsx(R,{onClick:F,disabled:y,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700",children:y?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"Scraping in Progress..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Start Competitor Scraping"]})})]})]}),t&&e.jsxs(x,{className:"bg-gray-800/50 border-gray-700",children:[e.jsx(g,{children:e.jsxs(m,{className:"text-blue-400 flex items-center gap-2",children:[B(t.status),"Scraping Progress"]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-300",children:"Overall Progress"}),e.jsxs("span",{className:"text-gray-300",children:[t.completed_stores,"/",t.total_stores," stores"]})]}),e.jsx(T,{value:L,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:t.completed_stores}),e.jsx("div",{className:"text-xs text-gray-400",children:"Stores Completed"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:t.products_found}),e.jsx("div",{className:"text-xs text-gray-400",children:"Products Found"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:t.errors.length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Errors"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-700/50 rounded-lg",children:[e.jsx(p,{className:D(t.status),children:t.status.toUpperCase()}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Status"})]})]}),t.current_store&&e.jsxs(C,{className:"bg-blue-500/10 border-blue-500/30",children:[e.jsx(j,{className:"h-4 w-4 animate-spin"}),e.jsxs(k,{className:"text-blue-300",children:["Currently scraping: ",e.jsx("strong",{children:t.current_store})]})]}),t.errors.length>0&&e.jsxs(C,{className:"bg-red-500/10 border-red-500/30",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsxs(k,{className:"text-red-300",children:[e.jsx("div",{className:"font-medium mb-1",children:"Errors encountered:"}),e.jsx("ul",{className:"text-xs space-y-1",children:t.errors.map((s,r)=>e.jsxs("li",{children:["â€¢ ",s]},r))})]})]})]})]}),a.length>0&&e.jsxs(x,{className:"bg-gray-800/50 border-gray-700",children:[e.jsxs(g,{children:[e.jsx(m,{className:"text-green-400",children:"Scraping Results"}),e.jsxs(w,{className:"text-gray-400",children:["Found ",a.length," products across ",new Set(a.map(s=>s.store_name)).size," stores"]})]}),e.jsxs(h,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left p-2 text-gray-300",children:"Store"}),e.jsx("th",{className:"text-left p-2 text-gray-300",children:"Product"}),e.jsx("th",{className:"text-left p-2 text-gray-300",children:"Price"}),e.jsx("th",{className:"text-left p-2 text-gray-300",children:"Brand"}),e.jsx("th",{className:"text-left p-2 text-gray-300",children:"Stock"})]})}),e.jsx("tbody",{children:a.slice(0,50).map((s,r)=>e.jsxs("tr",{className:"border-b border-gray-700/50 hover:bg-gray-700/30",children:[e.jsx("td",{className:"p-2 text-gray-300",children:s.store_name}),e.jsx("td",{className:"p-2 text-gray-300 max-w-xs truncate",title:s.title,children:s.title}),e.jsx("td",{className:"p-2 text-green-400 font-mono",children:s.price?`${s.currency} ${s.price.toFixed(2)}`:"N/A"}),e.jsx("td",{className:"p-2 text-gray-400",children:s.brand||"Unknown"}),e.jsx("td",{className:"p-2",children:e.jsx(p,{variant:s.in_stock?"default":"destructive",className:"text-xs",children:s.in_stock?"In Stock":"Out of Stock"})})]},r))})]})}),a.length>50&&e.jsxs("div",{className:"text-center mt-4 text-gray-400 text-sm",children:["Showing first 50 results. Total: ",a.length," products"]})]})]})]})})};export{H as default};
